<Window
    x:Class="PokerTracker2.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:local="clr-namespace:PokerTracker2"
    xmlns:controls="clr-namespace:PokerTracker2.Controls"
    xmlns:services="clr-namespace:PokerTracker2.Services"
    Title="Poker Session Tracker"
    Width="1400"
    Height="1400"
    WindowStartupLocation="CenterScreen"
    MinWidth="1200"
    MinHeight="1100"
    Background="Transparent"
    AllowsTransparency="True"
    WindowStyle="None">

    <!-- Animation Resources -->
    <Window.Resources>
        <!-- Window Animation Storyboards -->
        <Storyboard x:Key="MaximizeAnimation">
            <DoubleAnimation Storyboard.TargetProperty="(Window.Width)" 
                             From="1400" To="1920" Duration="0:0:0.3" 
                             EasingFunction="{StaticResource ExponentialEase}"/>
            <DoubleAnimation Storyboard.TargetProperty="(Window.Height)" 
                             From="1400" To="1580" Duration="0:0:0.3" 
                             EasingFunction="{StaticResource ExponentialEase}"/>
        </Storyboard>
        
        <Storyboard x:Key="RestoreAnimation">
            <DoubleAnimation Storyboard.TargetProperty="(Window.Width)" 
                             From="1920" To="1400" Duration="0:0:0.3" 
                             EasingFunction="{StaticResource ExponentialEase}"/>
            <DoubleAnimation Storyboard.TargetProperty="(Window.Height)" 
                             From="1580" To="1400" Duration="0:0:0.3" 
                             EasingFunction="{StaticResource ExponentialEase}"/>
        </Storyboard>
        
        <Storyboard x:Key="MinimizeAnimation">
            <DoubleAnimation Storyboard.TargetProperty="(Window.Opacity)" 
                             From="1.0" To="0.0" Duration="0:0:0.2" 
                             EasingFunction="{StaticResource ExponentialEase}"/>
        </Storyboard>
        
        <!-- Easing Functions -->
        <ExponentialEase x:Key="ExponentialEase" EasingMode="EaseInOut" Exponent="2"/>
        
        <!-- Value Converters -->
        <local:BalanceColorConverter x:Key="BalanceColorConverter"/>
        <local:ProfitColorConverter x:Key="ProfitColorConverter"/>
        <local:ProfitTextColorConverter x:Key="ProfitTextColorConverter"/>
        <local:StatusColorConverter x:Key="StatusColorConverter"/>
        <local:SessionVisibilityConverter x:Key="SessionVisibilityConverter"/>
        
        <!-- Sidebar Icon Button Style -->
        <Style x:Key="NavIconButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#40FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#60FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#60FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- Main window with glass effect -->
    <Border Background="#80000000" CornerRadius="8" BorderBrush="#40FFFFFF" BorderThickness="1">
        <Grid>
            <!-- Resize borders -->
            <Border x:Name="ResizeBorder" Background="Transparent" BorderThickness="5" 
                    MouseLeftButtonDown="ResizeBorder_MouseLeftButtonDown" 
                    MouseMove="ResizeBorder_MouseMove" 
                    Cursor="SizeAll"/>
            <!-- Main content -->
            <Grid>
                <!-- Custom Title Bar -->
                <Border x:Name="TitleBar" Grid.Row="0" Height="32" VerticalAlignment="Top" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#802A2A4E" Offset="0"/>
                            <GradientStop Color="#801A1A2E" Offset="0.7"/>
                            <GradientStop Color="#800F0F1F" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border.Effect>
                        <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" Opacity="0.4" BlurRadius="6"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="{Binding Source={x:Static services:VersionService.FormattedVersion}, StringFormat='Poker Session Tracker {0}'}" Foreground="White" VerticalAlignment="Center" Margin="10,0,0,0" FontSize="12"/>
                        <StackPanel Grid.Column="1" Orientation="Horizontal" Panel.ZIndex="10">
                            <Button Content="â”€" Width="45" Height="32" Background="Transparent" BorderThickness="0" Click="MinimizeButton_Click" Foreground="White" Cursor="Hand"/>
                            <Button Content="â–¡" Width="45" Height="32" Background="Transparent" BorderThickness="0" Click="MaximizeButton_Click" Foreground="White" Cursor="Hand"/>
                            <Button Content="âœ•" Width="45" Height="32" Background="Transparent" BorderThickness="0" Click="CloseButton_Click" Foreground="White" Cursor="Hand"/>
                        </StackPanel>
                        <!-- Inner highlight for shine effect -->
                        <Border Background="Transparent" BorderBrush="#40FFFFFF" BorderThickness="0,0,0,1" Opacity="0.3" Grid.ColumnSpan="2" Panel.ZIndex="1"/>
                    </Grid>
                </Border>
                
                <!-- Main Content -->
                <Grid Margin="0,32,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Condensed Icon Sidebar -->
                    <Border x:Name="Sidebar" Grid.Column="0" BorderBrush="#0F3460" BorderThickness="0,0,1,0">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#801E2A4E" Offset="0"/>
                                <GradientStop Color="#8016213E" Offset="0.8"/>
                                <GradientStop Color="#800F1A2E" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect Color="#000000" Direction="90" ShadowDepth="4" Opacity="0.5" BlurRadius="8"/>
                        </Border.Effect>
                        <Grid>
                            <StackPanel VerticalAlignment="Stretch" HorizontalAlignment="Center" Margin="0,20,0,20" Width="70">
                                <!-- Inner highlight for shine effect -->
                                <Border Background="Transparent" BorderBrush="#30FFFFFF" BorderThickness="1,0,0,0" Opacity="0.4" HorizontalAlignment="Left" VerticalAlignment="Stretch" Width="1"/>
                            <!-- App Icon -->
                            <Border CornerRadius="12" Padding="10" Margin="0,0,0,30">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="#801A4A80" Offset="0"/>
                                        <GradientStop Color="#800F3460" Offset="0.7"/>
                                        <GradientStop Color="#800A2A50" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <Border.Effect>
                                    <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" Opacity="0.4" BlurRadius="6"/>
                                </Border.Effect>
                                <Grid>
                                    <TextBlock Text="ðŸŽ°" FontSize="28" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    <!-- Inner highlight for shine effect -->
                                    <Border Background="Transparent" BorderBrush="#50FFFFFF" BorderThickness="1" CornerRadius="12" Opacity="0.4"/>
                                </Grid>
                            </Border>

                                                         <!-- Navigation Icons -->
                             <Button x:Name="DashboardButton" ToolTip="Dashboard" Click="DashboardButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                 <TextBlock Text="ðŸ " FontSize="24" HorizontalAlignment="Center" Foreground="#4FC3F7"/>
                             </Button>
                             <Button x:Name="ActiveSessionsButton" ToolTip="Active Sessions" Click="ActiveSessionsButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                 <TextBlock Text="ðŸ“Š" FontSize="24" HorizontalAlignment="Center" Foreground="#4FC3F7"/>
                             </Button>
                             <Button x:Name="SessionManagementButton" ToolTip="Session Management" Click="SessionManagementButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                 <TextBlock Text="ðŸŽ®" FontSize="24" HorizontalAlignment="Center" Foreground="#4FC3F7"/>
                             </Button>
                             <Button x:Name="SessionHistoryButton" ToolTip="Session History" Click="SessionHistoryButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                 <TextBlock Text="ðŸ“" FontSize="24" HorizontalAlignment="Center" Foreground="#4FC3F7"/>
                             </Button>
                            <Button x:Name="PlayersButton" ToolTip="Players" Click="PlayersButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                <TextBlock Text="ðŸ‘¥" FontSize="24" HorizontalAlignment="Center" Foreground="#4FC3F7"/>
                            </Button>
                            <Button x:Name="AnalyticsButton" ToolTip="Analytics" Click="AnalyticsButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                <TextBlock Text="ðŸ“ˆ" FontSize="24" HorizontalAlignment="Center" Foreground="#4FC3F7"/>
                            </Button>

                            <!-- Spacer -->
                            <Border Height="1" Background="#40FFFFFF" Margin="0,20,0,20" Opacity="0.3"/>

                            <!-- Quick Actions -->
                            <Button x:Name="NewSessionButton" ToolTip="New Session" Click="NewSessionButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                <TextBlock Text="âž•" FontSize="24" HorizontalAlignment="Center" Foreground="#4FC3F7"/>
                            </Button>
                            <Button x:Name="SettingsButton" ToolTip="Settings" Click="SettingsButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                <TextBlock Text="âš™ï¸" FontSize="24" HorizontalAlignment="Center" Foreground="#4FC3F7"/>
                            </Button>

                            <!-- Spacer -->
                            <Border Height="1" Background="#40FFFFFF" Margin="0,20,0,20" Opacity="0.3"/>

                            <!-- User Actions -->
                            <Button x:Name="LogoutButton" ToolTip="Logout" Click="LogoutButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                <TextBlock Text="ðŸšª" FontSize="24" HorizontalAlignment="Center" Foreground="#FF6B6B"/>
                            </Button>

                            <!-- Debug Tab -->
                            <Button x:Name="DebugButton" ToolTip="Debug Console" Click="DebugButton_Click" Style="{StaticResource NavIconButtonStyle}" Margin="0,0,0,10">
                                <TextBlock Text="ðŸ›" FontSize="24" HorizontalAlignment="Center" Foreground="#FFD700"/>
                            </Button>

                            <StackPanel VerticalAlignment="Bottom" Margin="0,40,0,0">
                                <TextBlock Text="Status: Ready" FontSize="10" Foreground="#CCCCCC" HorizontalAlignment="Center" Opacity="0.8"/>
                            </StackPanel>
                        </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Main Content Area -->
                    <Grid Grid.Column="1" x:Name="MainContent" Background="Transparent">
                                                 <!-- Dashboard Page -->
                         <Grid x:Name="DashboardPage" Visibility="Visible" Background="Transparent">
                            <!-- Background with decorative elements -->
                            <Grid>
                                <!-- Decorative background shapes -->
                                <Canvas>
                                    <!-- Large circle -->
                                    <Ellipse Canvas.Left="800" Canvas.Top="100" Width="300" Height="300" 
                                             Fill="#34988D" Opacity="0.1"/>
                                    <!-- Medium circle -->
                                    <Ellipse Canvas.Left="900" Canvas.Top="400" Width="150" Height="150" 
                                             Fill="#2C3E50" Opacity="0.15"/>
                                    <!-- Small decorative rectangles -->
                                    <Rectangle Canvas.Left="950" Canvas.Top="200" Width="80" Height="80" 
                                               Fill="#34988D" Opacity="0.2" RadiusX="8" RadiusY="8"/>
                                    <Rectangle Canvas.Left="1050" Canvas.Top="300" Width="60" Height="60" 
                                               Fill="#2C3E50" Opacity="0.25" RadiusX="6" RadiusY="6"/>
                                </Canvas>

                                <!-- Decorative icons on the right -->
                                <Canvas HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,50,50,0">
                                    <!-- Various decorative icons -->
                                    <TextBlock Canvas.Left="0" Canvas.Top="0" Text="ðŸ’Ž" FontSize="24" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="50" Canvas.Top="30" Text="ðŸ“Š" FontSize="20" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="100" Canvas.Top="10" Text="ðŸŽ¯" FontSize="22" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="150" Canvas.Top="40" Text="âœï¸" FontSize="18" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="200" Canvas.Top="20" Text="ðŸ“" FontSize="20" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="250" Canvas.Top="50" Text="ðŸ’»" FontSize="24" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="300" Canvas.Top="15" Text="ðŸ“±" FontSize="18" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="350" Canvas.Top="35" Text="ðŸ”²" FontSize="22" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="400" Canvas.Top="5" Text="â¬¡" FontSize="20" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="450" Canvas.Top="25" Text="{}" FontSize="16" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="500" Canvas.Top="45" Text="â¬œ" FontSize="18" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="550" Canvas.Top="15" Text="ðŸ’¬" FontSize="20" Opacity="0.25"/>
                                    
                                    <!-- Second row of icons -->
                                    <TextBlock Canvas.Left="20" Canvas.Top="80" Text="ðŸŽ²" FontSize="20" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="70" Canvas.Top="110" Text="ðŸƒ" FontSize="18" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="120" Canvas.Top="90" Text="ðŸ’°" FontSize="22" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="170" Canvas.Top="120" Text="ðŸ“ˆ" FontSize="16" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="220" Canvas.Top="100" Text="ðŸŽ®" FontSize="20" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="270" Canvas.Top="130" Text="ðŸ†" FontSize="18" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="320" Canvas.Top="95" Text="â­" FontSize="22" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="370" Canvas.Top="125" Text="ðŸŽª" FontSize="16" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="420" Canvas.Top="105" Text="ðŸŽ¨" FontSize="20" Opacity="0.3"/>
                                    <TextBlock Canvas.Left="470" Canvas.Top="135" Text="ðŸŽ­" FontSize="18" Opacity="0.25"/>
                                    <TextBlock Canvas.Left="520" Canvas.Top="115" Text="ðŸŽª" FontSize="16" Opacity="0.3"/>
                                </Canvas>

                                <!-- Main content -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Main content -->
                                     <StackPanel Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,0,0,0" MaxWidth="1200" MinWidth="800">
                                         <!-- Header -->
                                         <Border Background="#A0000000" CornerRadius="16" Padding="30" Margin="0,0,0,20" BorderBrush="#60FFFFFF" BorderThickness="1">
                                             <StackPanel>
                                                 <TextBlock Text="Dashboard" 
                                                            FontSize="28"
                                                            FontWeight="Bold"
                                                            Foreground="White"
                                                            HorizontalAlignment="Left"
                                                            Margin="0,0,0,10"/>
                                                 <TextBlock Text="Track your poker sessions and monitor performance" 
                                                            FontSize="16"
                                                            Foreground="#CCCCCC"
                                                            HorizontalAlignment="Left"
                                                            Opacity="0.8"/>
                                             </StackPanel>
                                         </Border>

                                         <!-- Player Selection -->
                                         <Border Background="#A0000000" CornerRadius="12" Padding="20" Margin="0,0,0,20" BorderBrush="#60FFFFFF" BorderThickness="1">
                                             <StackPanel>
                                                 <TextBlock Text="ðŸ‘¤ Player Profile" FontSize="18" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,15"/>
                                                 <Grid>
                                                     <Grid.ColumnDefinitions>
                                                         <ColumnDefinition Width="*"/>
                                                         <ColumnDefinition Width="Auto"/>
                                                     </Grid.ColumnDefinitions>
                                                     <ComboBox x:Name="PlayerSelectionComboBox" 
                                                               Grid.Column="0"
                                                               ItemsSource="{Binding AllPlayers}"
                                                               SelectedItem="{Binding SelectedPlayerProfile}"
                                                               DisplayMemberPath="DisplayName"
                                                               SelectedValuePath="Name"
                                                               Margin="0,0,10,0"
                                                               Background="#80000000"
                                                               Foreground="White"
                                                               BorderBrush="#60FFFFFF"
                                                               BorderThickness="1"
                                                               Padding="10,8"
                                                               FontSize="14"/>
                                                     <ui:Button Grid.Column="1" 
                                                                Content="View All Players" 
                                                                Appearance="Secondary" 
                                                                Click="PlayersButton_Click"/>
                                                 </Grid>
                                                 <TextBlock x:Name="SelectedPlayerInfo" 
                                                            Text="Select a player to view their profile and statistics" 
                                                            FontSize="12" 
                                                            Foreground="#CCCCCC" 
                                                            Opacity="0.8" 
                                                            Margin="0,10,0,0"/>
                                             </StackPanel>
                                         </Border>

                                         <!-- Quick Stats -->
                                         <Border x:Name="GlobalStatsPanel" Background="#A0000000" CornerRadius="12" Padding="20" Margin="0,0,0,20" BorderBrush="#60FFFFFF" BorderThickness="1">
                                             <Grid>
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                 </Grid.ColumnDefinitions>
                                                 
                                                 <!-- Total Sessions -->
                                                 <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸ“Š" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Total Sessions" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="TotalSessionsText" Text="0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                 </StackPanel>
                                                 
                                                 <!-- Active Sessions -->
                                                 <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸŽ¯" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Active Sessions" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="ActiveSessionsText" Text="0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#4FC3F7"/>
                                                 </StackPanel>
                                                 
                                                 <!-- Total Players -->
                                                 <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸ‘¥" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Total Players" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="TotalPlayersText" Text="0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                 </StackPanel>
                                                 
                                                                                                     <!-- Total Volume -->
                                                    <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                                        <TextBlock Text="ðŸ’°" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                        <TextBlock Text="Total Volume" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                        <TextBlock x:Name="TotalVolumeText" Text="$0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                    </StackPanel>
                                             </Grid>
                                         </Border>

                                         <!-- Player-Specific Stats (shown when player is selected) -->
                                         <Border x:Name="PlayerStatsPanel" 
                                                 Background="#A0000000" 
                                                 CornerRadius="12" 
                                                 Padding="20" 
                                                 Margin="0,0,0,20" 
                                                 BorderBrush="#60FFFFFF" 
                                                 BorderThickness="1"
                                                 Visibility="Collapsed">
                                             <Grid>
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                 </Grid.ColumnDefinitions>
                                                 
                                                 <!-- Player Sessions -->
                                                 <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸŽ²" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Player Sessions" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="PlayerSessionsText" Text="0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                 </StackPanel>
                                                 
                                                 <!-- Player Buy-ins -->
                                                 <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸ’µ" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Total Buy-ins" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="PlayerBuyInsText" Text="$0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                 </StackPanel>
                                                 
                                                 <!-- Player Cash-outs -->
                                                 <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸ’°" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Total Cash-outs" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="PlayerCashOutsText" Text="$0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                 </StackPanel>
                                                 
                                                 <!-- Player Net Profit -->
                                                 <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸ“ˆ" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,0" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Net Profit" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="PlayerNetProfitText" Text="$0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#4CAF50"/>
                                                 </StackPanel>
                                             </Grid>
                                         </Border>
                                         
                                         <!-- Additional Global Stats (hidden by default, shown when no player selected) -->
                                         <Border x:Name="AdditionalGlobalStatsPanel" 
                                                 Background="#A0000000" 
                                                 CornerRadius="12" 
                                                 Padding="20" 
                                                 Margin="0,0,0,20" 
                                                 BorderBrush="#60FFFFFF" 
                                                 BorderThickness="1"
                                                 Visibility="Collapsed">
                                             <Grid>
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                 </Grid.ColumnDefinitions>
                                                 
                                                 <!-- Average Session Profit -->
                                                 <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸ“Š" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Avg Session Profit" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="AvgSessionProfitText" Text="$0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                 </StackPanel>
                                                 
                                                 <!-- Best Session -->
                                                 <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸ†" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Best Session" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="BestSessionText" Text="$0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#4CAF50"/>
                                                 </StackPanel>
                                                 
                                                 <!-- Total Buy-ins -->
                                                 <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                                     <TextBlock Text="ðŸ’µ" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4FC3F7"/>
                                                     <TextBlock Text="Total Buy-ins" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                                     <TextBlock x:Name="TotalBuyInsText" Text="$0" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                 </StackPanel>
                                             </Grid>
                                         </Border>

                                         <!-- Recent Sessions -->
                                         <Border Background="#A0000000" CornerRadius="12" Padding="20" Margin="0,0,0,20" BorderBrush="#60FFFFFF" BorderThickness="1">
                                             <StackPanel>
                                                 <Grid Margin="0,0,0,15">
                                                     <Grid.ColumnDefinitions>
                                                         <ColumnDefinition Width="*"/>
                                                         <ColumnDefinition Width="Auto"/>
                                                     </Grid.ColumnDefinitions>
                                                     <TextBlock Grid.Column="0" Text="Recent Sessions" FontSize="18" FontWeight="SemiBold" Foreground="White"/>
                                                     <ui:Button Grid.Column="1" Content="View All" Appearance="Secondary" Click="SessionHistoryButton_Click"/>
                                                 </Grid>
                                                 
                                                 <!-- Recent Sessions List -->
                                                 <ItemsControl x:Name="RecentSessionsList">
                                                     <ItemsControl.ItemTemplate>
                                                         <DataTemplate>
                                                             <Border Background="#80000000" CornerRadius="8" Padding="15" Margin="0,5" BorderBrush="#40FFFFFF" BorderThickness="1">
                                                                 <Grid>
                                                                     <Grid.RowDefinitions>
                                                                         <RowDefinition Height="Auto"/>
                                                                         <RowDefinition Height="Auto"/>
                                                                     </Grid.RowDefinitions>
                                                                     
                                                                     <Grid Grid.Row="0">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         
                                                                         <TextBlock Grid.Column="0" Text="{Binding Name}" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                                                         <Border Grid.Column="1" Background="{Binding IsActive, Converter={StaticResource StatusColorConverter}}" CornerRadius="4" Padding="6,2">
                                                                             <TextBlock Text="{Binding StatusText}" FontSize="10" FontWeight="Bold" Foreground="White"/>
                                                                         </Border>
                                                                     </Grid>
                                                                     
                                                                     <Grid Grid.Row="1" Margin="0,5,0,0">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         
                                                                         <TextBlock Grid.Column="0" Text="{Binding DurationText}" FontSize="11" Foreground="#4FC3F7"/>
                                                                         <TextBlock Grid.Column="1" Text="{Binding TotalBuyIns, StringFormat='Buy-ins: ${0:F2}'}" FontSize="11" Foreground="#CCCCCC" Margin="10,0,0,0"/>
                                                                         <TextBlock Grid.Column="2" Text="{Binding ProfitText}" FontSize="11" FontWeight="Bold" Margin="10,0,0,0">
                                                                             <TextBlock.Foreground>
                                                                                 <SolidColorBrush Color="{Binding NetProfit, Converter={StaticResource ProfitColorConverter}}"/>
                                                                             </TextBlock.Foreground>
                                                                         </TextBlock>
                                                                     </Grid>
                                                                 </Grid>
                                                             </Border>
                                                         </DataTemplate>
                                                     </ItemsControl.ItemTemplate>
                                                 </ItemsControl>
                                                 
                                                 <!-- Empty State -->
                                                 <Border x:Name="NoSessionsMessage" Background="#80000000" CornerRadius="8" Padding="40" Margin="5" BorderBrush="#40FFFFFF" BorderThickness="1" Visibility="Collapsed">
                                                     <StackPanel HorizontalAlignment="Center">
                                                         <TextBlock Text="ðŸ“" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,10" Foreground="#4FC3F7"/>
                                                         <TextBlock Text="No sessions yet" FontSize="16" FontWeight="SemiBold" Foreground="White" HorizontalAlignment="Center"/>
                                                         <TextBlock Text="Create your first session to get started" FontSize="12" Foreground="#CCCCCC" Opacity="0.8" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                                         <ui:Button Content="Create New Session" Appearance="Primary" Click="NewSessionButton_Click" Margin="0,15,0,0"/>
                                                     </StackPanel>
                                                 </Border>
                                             </StackPanel>
                                         </Border>

                                         <!-- Quick Actions -->
                                         <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,0">
                                             <ui:Button Content="âž• New Session" Appearance="Primary" Margin="0,0,10,0" Click="NewSessionButton_Click"/>
                                             <ui:Button Content="ðŸ“Š Active Sessions" Appearance="Secondary" Margin="0,0,10,0" Click="ActiveSessionsButton_Click"/>
                                             <ui:Button Content="ðŸ“ˆ Analytics" Appearance="Secondary" Margin="0,0,10,0" Click="AnalyticsButton_Click"/>
                                             <ui:Button x:Name="CheckForUpdatesButton" Content="ðŸ” Check for Updates" Appearance="Secondary" Click="CheckForUpdates_Click"/>
                                         </StackPanel>
                                     </StackPanel>
                                    
                                    <!-- Decorative element to restore width -->
                                    <Grid Grid.Column="1" Width="100">
                                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Opacity="0.1">
                                            <TextBlock Text="ðŸŽ²" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                                            <TextBlock Text="Poker Session Tracker" FontSize="16" HorizontalAlignment="Center" Foreground="White"/>
                                        </StackPanel>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </Grid>

                        <!-- New Session Page -->
                        <Grid x:Name="NewSessionPage" Visibility="Collapsed" Background="Transparent">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Page Header -->
                            <Border x:Name="NewSessionHeader" Grid.Row="0" BorderBrush="#0F3460" BorderThickness="0,0,0,1" Padding="20">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="#802A2A4E" Offset="0"/>
                                        <GradientStop Color="#801A1A2E" Offset="0.6"/>
                                        <GradientStop Color="#800F0F1F" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <Border.Effect>
                                    <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" Opacity="0.4" BlurRadius="6"/>
                                </Border.Effect>
                                                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <!-- Inner highlight for shine effect -->
                                    <Border Background="Transparent" BorderBrush="#40FFFFFF" BorderThickness="0,0,0,1" Opacity="0.3" Grid.RowSpan="2"/>
                                    <Grid Grid.Row="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock x:Name="SessionTitleText"
                                                       Text="New Poker Session"
                                                       FontSize="24"
                                                       FontWeight="Bold"
                                                       Foreground="White"/>
                                            <ui:Button Grid.Column="1" x:Name="RenameSessionTemplateButton"
                                                       Content="âœï¸"
                                                       Appearance="Secondary"
                                                       Width="32" Height="32"
                                                       Margin="10,0,0,0"
                                                       ToolTip="Rename Session"
                                                       Click="RenameSessionTemplate_Click"/>
                                        </Grid>
                                        <TextBlock x:Name="SessionIdText"
                                                   Text="Session ID: Not started"
                                                   FontSize="14"
                                                   Foreground="#CCCCCC"
                                                   Opacity="0.7"
                                                   Margin="0,5,0,0"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                        <ui:Button x:Name="SaveSessionButton"
                                                   Content="ðŸ’¾ Save"
                                                   Appearance="Primary"
                                                   Margin="0,0,10,0"
                                                   Click="SaveSessionButton_Click"/>
                                        <ui:Button x:Name="EndSessionButton"
                                                   Content="ðŸ End"
                                                   Appearance="Secondary"
                                                   Click="EndSessionButton_Click"/>
                                    </StackPanel>
                                </Grid>
                                </Grid>
                            </Border>

                            <!-- Main Content -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="20" Background="Transparent">
                                <StackPanel>
                                    <!-- Buy-ins Section -->
                                    <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Margin="0,0,0,20">
                                        <Grid Margin="20">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <TextBlock Grid.Row="0" Text="ðŸ’° Buy-ins" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                            
                                            <!-- Player Selection Section -->
                                            <Border Grid.Row="1" Background="#80000000" BorderBrush="#40FFFFFF" BorderThickness="1" CornerRadius="6" Margin="0,0,0,15" Padding="15">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    
                                                    <!-- Add Player Button -->
                                                    <Grid Grid.Row="0" Margin="0,0,0,10">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" 
                                                                   Text="Add players to your session:" 
                                                                   FontSize="14" 
                                                                   Foreground="#CCCCCC" 
                                                                   VerticalAlignment="Center"/>
                                                        <ui:Button Grid.Column="1" 
                                                                   x:Name="AddPlayerToNewSessionButton"
                                                                   Content="ðŸ‘¥ Add Player"
                                                                   Appearance="Primary"
                                                                   Click="AddPlayerToNewSession_Click"/>
                                                    </Grid>
                                                    
                                                    <!-- Empty state message -->
                                                    <TextBlock Grid.Row="1" 
                                                               x:Name="EmptyPlayersMessage"
                                                               Text="No players added yet. Click 'Add Player' to get started."
                                                               FontSize="12" 
                                                               Foreground="#888888" 
                                                               HorizontalAlignment="Center"
                                                               Margin="0,20"
                                                               Visibility="Visible"/>
                                                </Grid>
                                            </Border>
                                            <!-- Session Players List -->
                                            <ScrollViewer Grid.Row="2" MaxHeight="200" VerticalScrollBarVisibility="Auto" Background="Transparent">
                                                <ItemsControl x:Name="PlayersList">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border Background="#60000000" CornerRadius="6" Padding="12,8" Margin="0,4">
                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="*"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                    </Grid.ColumnDefinitions>
                                                                    <TextBlock Grid.Column="0" 
                                                                               Text="{Binding Name}" 
                                                                               VerticalAlignment="Center" 
                                                                               Foreground="White"
                                                                               FontWeight="SemiBold"
                                                                               FontSize="14"/>
                                                                    <TextBlock Grid.Column="1" 
                                                                               Text="{Binding TotalBuyIn, StringFormat=C}" 
                                                                               VerticalAlignment="Center" 
                                                                               Margin="15,0" 
                                                                               Foreground="#4CAF50"
                                                                               FontWeight="Bold"/>
                                                                    <ui:Button Grid.Column="2" 
                                                                               Content="ðŸ’°" 
                                                                               ToolTip="Add Buy-in" 
                                                                               Appearance="Secondary" 
                                                                               Width="32" Height="32" 
                                                                               Margin="5,0"
                                                                               Click="AddBuyInButton_Click" 
                                                                               Tag="{Binding Name}"/>
                                                                    <ui:Button Grid.Column="3" 
                                                                               Content="ðŸ—‘ï¸" 
                                                                               ToolTip="Remove Player" 
                                                                               Appearance="Danger" 
                                                                               Width="32" Height="32"
                                                                               Click="RemovePlayerFromSession_Click" 
                                                                               Tag="{Binding Name}"/>
                                                                </Grid>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                        </Grid>
                                    </Border>
                                    <!-- Session Summary -->
                                    <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Margin="0,0,0,20">
                                        <Grid Margin="20">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <TextBlock Grid.Row="0" Text="ðŸ“Š Session Summary" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                            <Grid Grid.Row="1" Margin="0,5">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="Total Buy-ins:" FontSize="14" Foreground="#CCCCCC"/>
                                                <TextBlock Grid.Column="1" Text="{Binding TotalBuyIn}" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                            </Grid>
                                        </Grid>
                                    </Border>
                                    <!-- Notes Section -->
                                    <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8">
                                        <Grid Margin="20">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            <TextBlock Grid.Row="0" Text="ðŸ“ Session Notes" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                            <ui:TextBox Grid.Row="1" x:Name="SessionNotesTextBox"
                                                        AcceptsReturn="True"
                                                        TextWrapping="Wrap"
                                                        Height="100"
                                                        PlaceholderText="Add session notes here..."
                                                        Text="{Binding SessionNotes, UpdateSourceTrigger=PropertyChanged}"/>
                                        </Grid>
                                    </Border>
                                </StackPanel>
                            </ScrollViewer>
                            <!-- Status Bar -->
                            <Border Grid.Row="2" Background="#1A1A2E" BorderBrush="#0F3460" BorderThickness="0,1,0,0" Padding="20,10">
                                <Border.Effect>
                                    <DropShadowEffect Color="#000000" Direction="90" ShadowDepth="2" Opacity="0.3" BlurRadius="4"/>
                                </Border.Effect>
                                <TextBlock x:Name="StatusText"
                                           Text="Ready to track your poker session"
                                           FontSize="14"
                                           Foreground="#CCCCCC"
                                           VerticalAlignment="Center"/>
                            </Border>
                        </Grid>
                                                 <!-- Active Sessions Page -->
                         <Grid x:Name="ActiveSessionsPage" Visibility="Collapsed" Background="Transparent">
                             <Grid.RowDefinitions>
                                 <RowDefinition Height="Auto"/>
                                 <RowDefinition Height="*"/>
                             </Grid.RowDefinitions>
                             
                             <!-- Page Header -->
                             <Border Grid.Row="0" BorderBrush="#0F3460" BorderThickness="0,0,0,1" Padding="20">
                                 <Border.Background>
                                     <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                         <GradientStop Color="#802A2A4E" Offset="0"/>
                                         <GradientStop Color="#801A1A2E" Offset="0.6"/>
                                         <GradientStop Color="#800F0F1F" Offset="1"/>
                                     </LinearGradientBrush>
                                 </Border.Background>
                                 <Border.Effect>
                                     <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" Opacity="0.4" BlurRadius="6"/>
                                 </Border.Effect>
                                 <Grid>
                                     <Grid.RowDefinitions>
                                         <RowDefinition Height="Auto"/>
                                         <RowDefinition Height="*"/>
                                     </Grid.RowDefinitions>
                                     <!-- Inner highlight for shine effect -->
                                     <Border Background="Transparent" BorderBrush="#40FFFFFF" BorderThickness="0,0,0,1" Opacity="0.3" Grid.RowSpan="2"/>
                                     <TextBlock Grid.Row="0" Text="ðŸ“Š Active Sessions" FontSize="24" FontWeight="Bold" Foreground="White"/>
                                     <TextBlock Grid.Row="1" Text="Currently running poker sessions" FontSize="14" Foreground="#CCCCCC" Opacity="0.7" Margin="0,5,0,0"/>
                                 </Grid>
                             </Border>
                             
                             <!-- Main Content -->
                             <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="20" Background="Transparent">
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="20"/>
                                         <ColumnDefinition Width="300"/>
                                     </Grid.ColumnDefinitions>
                                     
                                     <!-- Active Sessions List -->
                                     <Border Grid.Column="0" Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8">
                                         <Grid Margin="20">
                                             <Grid.RowDefinitions>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="*"/>
                                             </Grid.RowDefinitions>
                                             
                                             <TextBlock Grid.Row="0" Text="Active Sessions" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                             
                                             <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Background="Transparent">
                                                 <ItemsControl x:Name="ActiveSessionsList">
                                                     <ItemsControl.ItemTemplate>
                                                         <DataTemplate>
                                                             <Border Background="#80000000" CornerRadius="8" Padding="20" Margin="0,10" BorderBrush="#40FFFFFF" BorderThickness="1">
                                                                 <Grid>
                                                                     <Grid.RowDefinitions>
                                                                         <RowDefinition Height="Auto"/>
                                                                         <RowDefinition Height="Auto"/>
                                                                         <RowDefinition Height="Auto"/>
                                                                         <RowDefinition Height="Auto"/>
                                                                     </Grid.RowDefinitions>
                                                                     
                                                                     <Grid Grid.Row="0">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         
                                                                         <TextBlock Grid.Column="0" Text="{Binding Name}" FontSize="18" FontWeight="Bold" Foreground="White"/>
                                                                         <Border Grid.Column="1" Background="#4CAF50" CornerRadius="4" Padding="8,4">
                                                                             <TextBlock Text="ACTIVE" FontSize="10" FontWeight="Bold" Foreground="White"/>
                                                                         </Border>
                                                                     </Grid>
                                                                     
                                                                     <TextBlock Grid.Row="1" Text="{Binding StartTime, StringFormat='Started: {0:g}'}" FontSize="14" Foreground="#CCCCCC" Margin="0,10,0,5"/>
                                                                     <TextBlock Grid.Row="2" Text="{Binding DurationText, StringFormat='Duration: {0}'}" FontSize="14" Foreground="#4FC3F7" Margin="0,5,0,10"/>
                                                                     
                                                                     <Grid Grid.Row="3">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         
                                                                         <StackPanel Grid.Column="0">
                                                                             <TextBlock Text="Buy-ins" FontSize="12" Foreground="#CCCCCC"/>
                                                                             <TextBlock Text="{Binding TotalBuyIns, StringFormat='${0:F2}'}" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                                                         </StackPanel>
                                                                         
                                                                         <StackPanel Grid.Column="1">
                                                                             <TextBlock Text="Players" FontSize="12" Foreground="#CCCCCC"/>
                                                                             <TextBlock Text="{Binding Players.Count}" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                                                         </StackPanel>
                                                                         
                                                                                                                                          <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <ui:Button Content="ðŸ“‚ Load" Appearance="Primary" Margin="0,0,10,0" Click="LoadActiveSession_Click" Tag="{Binding}"/>
                            <ui:Button Content="ðŸ End" Appearance="Secondary" Click="EndActiveSession_Click" Tag="{Binding}"/>
                        </StackPanel>
                                                                     </Grid>
                                                                 </Grid>
                                                             </Border>
                                                         </DataTemplate>
                                                     </ItemsControl.ItemTemplate>
                                                 </ItemsControl>
                                             </ScrollViewer>
                                         </Grid>
                                     </Border>
                                     
                                     <!-- No Active Sessions Message -->
                                     <Border Grid.Column="0" x:Name="NoActiveSessionsMessage" Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Visibility="Collapsed">
                                         <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Margin="40">
                                             <TextBlock Text="ðŸ“Š" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,20" Foreground="#4FC3F7"/>
                                             <TextBlock Text="No Active Sessions" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,10" Foreground="White"/>
                                             <TextBlock Text="Currently running poker sessions" FontSize="16" HorizontalAlignment="Center" Opacity="0.7" Foreground="#CCCCCC" Margin="0,0,0,30"/>
                                             <ui:Button Content="âž• Create New Session" Appearance="Primary" Click="CreateNewSessionFromActive_Click"/>
                                         </StackPanel>
                                     </Border>
                                     
                                     <!-- Quick Stats -->
                                     <Border Grid.Column="2" Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8">
                                         <Grid Margin="20">
                                             <Grid.RowDefinitions>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="*"/>
                                             </Grid.RowDefinitions>
                                             
                                             <TextBlock Grid.Row="0" Text="ðŸ“ˆ Quick Stats" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,20" Foreground="White"/>
                                             
                                             <StackPanel Grid.Row="1" Margin="0,0,0,15">
                                                 <TextBlock Text="Active Sessions" FontSize="12" Foreground="#CCCCCC"/>
                                                 <TextBlock x:Name="ActiveSessionsCountText" Text="0" FontSize="20" FontWeight="Bold" Foreground="#4FC3F7"/>
                                             </StackPanel>
                                             
                                             <StackPanel Grid.Row="2" Margin="0,0,0,15">
                                                 <TextBlock Text="Total Buy-ins" FontSize="12" Foreground="#CCCCCC"/>
                                                 <TextBlock x:Name="ActiveSessionsTotalBuyInsText" Text="$0.00" FontSize="20" FontWeight="Bold" Foreground="White"/>
                                             </StackPanel>
                                             
                                             <StackPanel Grid.Row="3" Margin="0,0,0,20">
                                                 <TextBlock Text="Total Players" FontSize="12" Foreground="#CCCCCC"/>
                                                 <TextBlock x:Name="ActiveSessionsTotalPlayersText" Text="0" FontSize="20" FontWeight="Bold" Foreground="White"/>
                                             </StackPanel>
                                             
                                             <Border Grid.Row="4" Height="1" Background="#40FFFFFF" Margin="0,0,0,20"/>
                                             
                                             <ui:Button Grid.Row="5" Content="âž• New Session" Appearance="Primary" Click="CreateNewSessionFromActive_Click"/>
                                         </Grid>
                                     </Border>
                                 </Grid>
                             </ScrollViewer>
                         </Grid>
                         
                         <!-- Session History Page -->
                         <Grid x:Name="SessionHistoryPage" Visibility="Collapsed" Background="Transparent">
                             <Grid.RowDefinitions>
                                 <RowDefinition Height="Auto"/>
                                 <RowDefinition Height="*"/>
                             </Grid.RowDefinitions>
                             
                             <!-- Page Header -->
                             <Border Grid.Row="0" BorderBrush="#0F3460" BorderThickness="0,0,0,1" Padding="20">
                                 <Border.Background>
                                     <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                         <GradientStop Color="#802A2A4E" Offset="0"/>
                                         <GradientStop Color="#801A1A2E" Offset="0.6"/>
                                         <GradientStop Color="#800F0F1F" Offset="1"/>
                                     </LinearGradientBrush>
                                 </Border.Background>
                                 <Border.Effect>
                                     <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" Opacity="0.4" BlurRadius="6"/>
                                 </Border.Effect>
                                 <Grid>
                                     <Grid.RowDefinitions>
                                         <RowDefinition Height="Auto"/>
                                         <RowDefinition Height="*"/>
                                     </Grid.RowDefinitions>
                                     <!-- Inner highlight for shine effect -->
                                     <Border Background="Transparent" BorderBrush="#40FFFFFF" BorderThickness="0,0,0,1" Opacity="0.3" Grid.RowSpan="2"/>
                                     <Grid Grid.Row="1">
                                         <Grid.ColumnDefinitions>
                                             <ColumnDefinition Width="*"/>
                                             <ColumnDefinition Width="Auto"/>
                                         </Grid.ColumnDefinitions>
                                         <TextBlock Grid.Column="0" Text="ðŸ“ Session History" FontSize="24" FontWeight="Bold" Foreground="White"/>
                                         <StackPanel Grid.Column="1" Orientation="Horizontal">
                                             <ui:Button Content="ðŸ”„ Refresh" Appearance="Secondary" Margin="0,0,10,0" Click="RefreshSessionHistory_Click"/>
                                             <ui:Button Content="ðŸ“Š Export" Appearance="Secondary" Click="ExportSessionHistory_Click"/>
                                         </StackPanel>
                                     </Grid>
                                 </Grid>
                             </Border>
                             
                             <!-- Main Content -->
                             <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="20" Background="Transparent">
                                 <StackPanel>
                                     <!-- Statistics Summary -->
                                     <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Margin="0,0,0,20">
                                         <Grid Margin="20">
                                             <Grid.ColumnDefinitions>
                                                 <ColumnDefinition Width="*"/>
                                                 <ColumnDefinition Width="*"/>
                                                 <ColumnDefinition Width="*"/>
                                                 <ColumnDefinition Width="*"/>
                                             </Grid.ColumnDefinitions>
                                             
                                             <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                                 <TextBlock x:Name="HistoryTotalSessionsText" Text="0" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                 <TextBlock Text="Total Sessions" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                             </StackPanel>
                                             
                                             <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                                 <TextBlock x:Name="HistoryTotalProfitText" Text="$0.00" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#4CAF50"/>
                                                 <TextBlock Text="Total Profit" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                             </StackPanel>
                                             
                                             <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                                 <TextBlock x:Name="HistoryAverageProfitText" Text="$0.00" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                                                 <TextBlock Text="Average per Session" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                             </StackPanel>
                                             
                                             <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                                 <TextBlock x:Name="HistoryBestSessionText" Text="$0.00" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#4CAF50"/>
                                                 <TextBlock Text="Best Session" FontSize="12" HorizontalAlignment="Center" Foreground="#CCCCCC" Opacity="0.8"/>
                                             </StackPanel>
                                         </Grid>
                                     </Border>
                                     
                                     <!-- Sessions List -->
                                     <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8">
                                         <Grid Margin="20">
                                             <Grid.RowDefinitions>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="*"/>
                                             </Grid.RowDefinitions>
                                             
                                             <TextBlock Grid.Row="0" Text="Completed Sessions" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                             
                                             <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Background="Transparent">
                                                 <ItemsControl x:Name="SessionHistoryList">
                                                     <ItemsControl.ItemTemplate>
                                                         <DataTemplate>
                                                             <Border Background="#80000000" CornerRadius="8" Padding="20" Margin="0,10" BorderBrush="#40FFFFFF" BorderThickness="1">
                                                                 <Grid>
                                                                     <Grid.RowDefinitions>
                                                                         <RowDefinition Height="Auto"/>
                                                                         <RowDefinition Height="Auto"/>
                                                                         <RowDefinition Height="Auto"/>
                                                                         <RowDefinition Height="Auto"/>
                                                                     </Grid.RowDefinitions>
                                                                     
                                                                     <!-- Session Header Row -->
                                                                     <Grid Grid.Row="0">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         
                                                                         <TextBlock Grid.Column="0" Text="{Binding Name}" FontSize="18" FontWeight="Bold" Foreground="White"/>
                                                                         <Border Grid.Column="1" Background="#FF9800" CornerRadius="4" Padding="8,4">
                                                                             <TextBlock Text="COMPLETED" FontSize="10" FontWeight="Bold" Foreground="White"/>
                                                                         </Border>
                                                                     </Grid>
                                                                     
                                                                     <!-- Session Time Information Row -->
                                                                     <Grid Grid.Row="1" Margin="0,10,0,5">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="*"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         
                                                                         <TextBlock Grid.Column="0" Text="{Binding StartTime, StringFormat='Started: {0:g}'}" FontSize="14" Foreground="#CCCCCC"/>
                                                                         <TextBlock Grid.Column="1" Text="{Binding EndTime, StringFormat='Ended: {0:g}'}" FontSize="14" Foreground="#CCCCCC"/>
                                                                         <TextBlock Grid.Column="2" Text="{Binding DurationText, StringFormat='Duration: {0}'}" FontSize="14" Foreground="#4FC3F7"/>
                                                                     </Grid>
                                                                     
                                                                     <!-- Session Financial Summary Row -->
                                                                     <Grid Grid.Row="2" Margin="0,10,0,0">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="*"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         
                                                                         <StackPanel Grid.Column="0">
                                                                             <TextBlock Text="Buy-ins" FontSize="12" Foreground="#CCCCCC"/>
                                                                             <TextBlock Text="{Binding TotalBuyIns, StringFormat='${0:F2}'}" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                                                         </StackPanel>
                                                                         
                                                                         <StackPanel Grid.Column="1">
                                                                             <TextBlock Text="Cash-outs" FontSize="12" Foreground="#CCCCCC"/>
                                                                             <TextBlock Text="{Binding TotalCashOuts, StringFormat='${0:F2}'}" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                                                         </StackPanel>
                                                                         
                                                                         <StackPanel Grid.Column="2">
                                                                             <TextBlock Text="Net Profit" FontSize="12" Foreground="#CCCCCC"/>
                                                                             <TextBlock Text="{Binding NetProfit, StringFormat='${0:F2}'}" FontSize="16" FontWeight="Bold">
                                                                                 <TextBlock.Foreground>
                                                                                     <SolidColorBrush Color="{Binding NetProfit, Converter={StaticResource ProfitColorConverter}}"/>
                                                                                 </TextBlock.Foreground>
                                                                             </TextBlock>
                                                                         </StackPanel>
                                                                     </Grid>
                                                                     
                                                                     <!-- Action Buttons Row -->
                                                                     <Grid Grid.Row="3" Margin="0,15,0,0">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         
                                                                         <!-- Left side empty for spacing -->
                                                                         <StackPanel Grid.Column="1" Orientation="Horizontal">
                                                                             <ui:Button Content="ðŸ‘ï¸ View" Appearance="Secondary" Margin="0,0,5,0" Click="ViewSessionDetails_Click" Tag="{Binding}"/>
                                                                             <ui:Button Content="ðŸ“‚ Load" Appearance="Secondary" Margin="0,0,5,0" Click="LoadSessionFromHistory_Click" Tag="{Binding}"/>
                                                                             <ui:Button Content="ðŸ—‘ï¸ Delete" Appearance="Secondary" Click="DeleteSessionFromHistory_Click" Tag="{Binding}"/>
                                                                         </StackPanel>
                                                                     </Grid>
                                                                 </Grid>
                                                             </Border>
                                                         </DataTemplate>
                                                     </ItemsControl.ItemTemplate>
                                                 </ItemsControl>
                                             </ScrollViewer>
                                         </Grid>
                                     </Border>
                                     
                                     <!-- No Sessions Message -->
                                     <Border x:Name="NoHistorySessionsMessage" Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Visibility="Collapsed">
                                         <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Margin="40">
                                             <TextBlock Text="ðŸ“" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,20" Foreground="#4FC3F7"/>
                                             <TextBlock Text="No Completed Sessions" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,10" Foreground="White"/>
                                             <TextBlock Text="Complete a session to see it here" FontSize="16" HorizontalAlignment="Center" Opacity="0.7" Foreground="#CCCCCC"/>
                                         </StackPanel>
                                     </Border>
                                 </StackPanel>
                             </ScrollViewer>
                         </Grid>
                         
                         <!-- Players Page -->
                         <Grid x:Name="PlayersPage" Visibility="Collapsed" Background="Transparent">
                             <Grid.RowDefinitions>
                                 <RowDefinition Height="Auto"/>
                                 <RowDefinition Height="*"/>
                                 <RowDefinition Height="Auto"/>
                             </Grid.RowDefinitions>

                             <!-- Page Header -->
                             <Border x:Name="PlayersHeader" Grid.Row="0" BorderBrush="#0F3460" BorderThickness="0,0,0,1" Padding="20">
                                 <Border.Background>
                                     <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                         <GradientStop Color="#802A2A4E" Offset="0"/>
                                         <GradientStop Color="#801A1A2E" Offset="0.6"/>
                                         <GradientStop Color="#800F0F1F" Offset="1"/>
                                     </LinearGradientBrush>
                                 </Border.Background>
                                 <Border.Effect>
                                     <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" Opacity="0.4" BlurRadius="6"/>
                                 </Border.Effect>
                                                                  <Grid>
                                     <Grid.RowDefinitions>
                                         <RowDefinition Height="Auto"/>
                                         <RowDefinition Height="*"/>
                                     </Grid.RowDefinitions>
                                     <!-- Inner highlight for shine effect -->
                                     <Border Background="Transparent" BorderBrush="#40FFFFFF" BorderThickness="0,0,0,1" Opacity="0.3" Grid.RowSpan="2"/>
                                     <Grid Grid.Row="1">
                                         <Grid.ColumnDefinitions>
                                             <ColumnDefinition Width="*"/>
                                             <ColumnDefinition Width="Auto"/>
                                         </Grid.ColumnDefinitions>
                                     <TextBlock Grid.Column="0" Text="ðŸ‘¥ Player Profiles" FontSize="24" FontWeight="Bold" Foreground="White"/>
                                     <StackPanel Grid.Column="1" Orientation="Horizontal">
                                         <ui:Button x:Name="TestFirebaseButton" Content="ðŸ”— Test Firebase" Appearance="Secondary" Margin="0,0,10,0" Click="TestFirebase_Click"/>
                                         <ui:Button x:Name="CreateNewPlayerButton" Content="âž• New Player" Appearance="Primary" Margin="0,0,10,0" Click="CreateNewPlayer_Click"/>
                                         <ui:Button x:Name="EditPlayerButton" Content="âœï¸ Edit" Appearance="Secondary" Margin="0,0,10,0" Click="EditPlayer_Click"/>
                                         <ui:Button x:Name="DeletePlayerButton" Content="ðŸ—‘ï¸ Delete" Appearance="Secondary" Margin="0,0,10,0" Click="DeletePlayer_Click"/>
                                         <ui:Button x:Name="FixCorruptedDataButton" Content="ðŸ”§ Fix Data" Appearance="Secondary" Click="FixCorruptedData_Click" ToolTip="Fix corrupted session data and recalculate totals"/>
                                     </StackPanel>
                                 </Grid>
                                 </Grid>
                             </Border>

                             <!-- Main Content -->
                             <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="20" Background="Transparent">
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="300"/>
                                         <ColumnDefinition Width="20"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>

                                     <!-- Player List -->
                                     <Border Grid.Column="0" Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8">
                                         <Grid Margin="0">
                                             <Grid.RowDefinitions>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="*"/>
                                             </Grid.RowDefinitions>
                                             
                                             <!-- Search -->
                                             <ui:TextBox Grid.Row="0" x:Name="PlayerListSearchTextBox"
                                                         PlaceholderText="Search players..."
                                                         Text="{Binding PlayerSearchText, UpdateSourceTrigger=PropertyChanged}"
                                                         Margin="15,15,15,10"/>
                                             
                                             <!-- Player List -->
                                             <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Background="Transparent">
                                                 <ListBox x:Name="PlayerProfilesList" ItemsSource="{Binding AllPlayers}" Background="Transparent" BorderThickness="0" Margin="0,0,0,15">
                                                     <ListBox.ItemTemplate>
                                                         <DataTemplate>
                                                             <Border Background="#80000000" CornerRadius="6" Padding="100,16,100,16" Margin="0,4" 
                                                                     BorderBrush="#40FFFFFF" BorderThickness="1"
                                                                     MouseLeftButtonDown="PlayerCard_Click" Tag="{Binding}"
                                                                     Cursor="Hand" MinHeight="80">
                                                                 <StackPanel VerticalAlignment="Center">
                                                                     <TextBlock Text="{Binding DisplayName}" FontSize="16" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,4"/>
                                                                     <TextBlock Text="{Binding Email}" FontSize="12" Foreground="#CCCCCC" Margin="0,0,0,8"/>
                                                                     <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                                                                         <TextBlock Text="{Binding TotalSessionsPlayed}" FontSize="12" Foreground="#4FC3F7"/>
                                                                         <TextBlock Text=" sessions" FontSize="12" Foreground="#CCCCCC"/>
                                                                         <TextBlock Text=" â€¢ " FontSize="12" Foreground="#CCCCCC"/>
                                                                         <TextBlock Text="{Binding LifetimeProfit, StringFormat='C'}" FontSize="12" Foreground="#4FC3F7"/>
                                                                     </StackPanel>
                                                                 </StackPanel>
                                                             </Border>
                                                         </DataTemplate>
                                                     </ListBox.ItemTemplate>
                                                     <ListBox.ItemContainerStyle>
                                                         <Style TargetType="ListBoxItem">
                                                             <Setter Property="Background" Value="Transparent"/>
                                                             <Setter Property="BorderThickness" Value="0"/>
                                                             <Setter Property="Margin" Value="0"/>
                                                             <Setter Property="Padding" Value="0"/>
                                                         </Style>
                                                     </ListBox.ItemContainerStyle>
                                                 </ListBox>
                                             </ScrollViewer>
                                         </Grid>
                                     </Border>

                                     <!-- Player Details -->
                                     <Border Grid.Column="2" Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8">
                                         <Grid Margin="20">
                                             <Grid.RowDefinitions>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="*"/>
                                             </Grid.RowDefinitions>
                                             
                                             <!-- Player Info -->
                                             <StackPanel Grid.Row="0" Margin="0,0,0,20">
                                                 <TextBlock x:Name="SelectedPlayerName" Text="Select a player to view details" FontSize="20" FontWeight="Bold" Foreground="White"/>
                                                 <TextBlock x:Name="SelectedPlayerEmail" Text="" FontSize="14" Foreground="#CCCCCC" Margin="0,5,0,0"/>
                                                 <TextBlock x:Name="SelectedPlayerPhone" Text="" FontSize="14" Foreground="#CCCCCC" Margin="0,2,0,0"/>
                                             </StackPanel>
                                             
                                             <!-- Statistics -->
                                             <Border Grid.Row="1" Background="#80000000" BorderBrush="#40FFFFFF" BorderThickness="1" CornerRadius="6" Padding="15" Margin="0,0,0,15">
                                                 <Grid>
                                                     <Grid.RowDefinitions>
                                                         <RowDefinition Height="Auto"/>
                                                         <RowDefinition Height="Auto"/>
                                                         <RowDefinition Height="Auto"/>
                                                         <RowDefinition Height="Auto"/>
                                                     </Grid.RowDefinitions>
                                                     <TextBlock Grid.Row="0" Text="ðŸ“Š Statistics" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10" Foreground="White"/>
                                                     
                                                     <Grid Grid.Row="1" Margin="0,5">
                                                         <Grid.ColumnDefinitions>
                                                             <ColumnDefinition Width="*"/>
                                                             <ColumnDefinition Width="Auto"/>
                                                         </Grid.ColumnDefinitions>
                                                         <TextBlock Grid.Column="0" Text="Total Sessions:" FontSize="14" Foreground="#CCCCCC"/>
                                                         <TextBlock Grid.Column="1" x:Name="SelectedPlayerSessions" Text="0" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                                     </Grid>
                                                     
                                                     <Grid Grid.Row="2" Margin="0,5">
                                                         <Grid.ColumnDefinitions>
                                                             <ColumnDefinition Width="*"/>
                                                             <ColumnDefinition Width="Auto"/>
                                                         </Grid.ColumnDefinitions>
                                                         <TextBlock Grid.Column="0" Text="Lifetime Buy-ins:" FontSize="14" Foreground="#CCCCCC"/>
                                                         <TextBlock Grid.Column="1" x:Name="SelectedPlayerBuyIns" Text="$0" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                                     </Grid>
                                                     
                                                     <Grid Grid.Row="3" Margin="0,5">
                                                         <Grid.ColumnDefinitions>
                                                             <ColumnDefinition Width="*"/>
                                                             <ColumnDefinition Width="Auto"/>
                                                         </Grid.ColumnDefinitions>
                                                         <TextBlock Grid.Column="0" Text="Lifetime Profit:" FontSize="14" Foreground="#CCCCCC"/>
                                                         <TextBlock Grid.Column="1" x:Name="SelectedPlayerProfit" Text="$0" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                                     </Grid>
                                                 </Grid>
                                             </Border>
                                             
                                             <!-- Notes -->
                                             <Border Grid.Row="2" Background="#80000000" BorderBrush="#40FFFFFF" BorderThickness="1" CornerRadius="6" Padding="15" Margin="0,0,0,15">
                                                 <Grid>
                                                     <Grid.RowDefinitions>
                                                         <RowDefinition Height="Auto"/>
                                                         <RowDefinition Height="Auto"/>
                                                     </Grid.RowDefinitions>
                                                     <TextBlock Grid.Row="0" Text="ðŸ“ Notes" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10" Foreground="White"/>
                                                     <TextBlock Grid.Row="1" x:Name="SelectedPlayerNotes" Text="No notes available" FontSize="14" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                                 </Grid>
                                             </Border>
                                             
                                             <!-- Recent Activity -->
                                             <Border Grid.Row="3" Background="#80000000" BorderBrush="#40FFFFFF" BorderThickness="1" CornerRadius="6" Padding="15">
                                                 <Grid>
                                                     <Grid.RowDefinitions>
                                                         <RowDefinition Height="Auto"/>
                                                         <RowDefinition Height="Auto"/>
                                                         <RowDefinition Height="Auto"/>
                                                         <RowDefinition Height="*"/>
                                                     </Grid.RowDefinitions>
                                                     
                                                     <!-- Header -->
                                                     <TextBlock Grid.Row="0" Text="ðŸ•’ Recent Activity" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                                     
                                                     <!-- Profit Line Graph -->
                                                     <Border Grid.Row="1" Background="#60000000" BorderBrush="#30FFFFFF" BorderThickness="1" CornerRadius="4" Padding="10" Margin="0,0,0,15">
                                                         <Grid>
                                                             <Grid.RowDefinitions>
                                                                 <RowDefinition Height="Auto"/>
                                                                 <RowDefinition Height="Auto"/>
                                                             </Grid.RowDefinitions>
                                                             <TextBlock Grid.Row="0" Text="ðŸ“ˆ Profit Trend" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="#4FC3F7"/>
                                                             <controls:BuyInLineGraph x:Name="PlayerProfitGraph" Grid.Row="1" Height="80" Width="Auto" HorizontalAlignment="Stretch" IsProfitGraph="True"/>
                                                         </Grid>
                                                     </Border>
                                                     
                                                     <!-- Session Summary -->
                                                     <Border Grid.Row="2" Background="#60000000" BorderBrush="#30FFFFFF" BorderThickness="1" CornerRadius="4" Padding="10" Margin="0,0,0,15">
                                                         <StackPanel>
                                                             <TextBlock Text="ðŸŽ¯ Session Summary" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="#4FC3F7"/>
                                                             <TextBlock x:Name="SessionSummaryText" Text="No session data available" FontSize="12" Foreground="#CCCCCC"/>
                                                         </StackPanel>
                                                     </Border>
                                                     
                                                     <!-- Transaction Summary Text -->
                                                     <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto" Background="Transparent">
                                                         <StackPanel>
                                                             <TextBlock Text="ðŸ’³ Transaction Summary" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="#4FC3F7"/>
                                                             <TextBlock x:Name="TransactionSummaryText" Text="No transaction data available" FontSize="12" Foreground="#CCCCCC"/>
                                                         </StackPanel>
                                                     </ScrollViewer>
                                                 </Grid>
                                             </Border>
                                         </Grid>
                                     </Border>
                                 </Grid>
                             </ScrollViewer>

                             <!-- Status Bar -->
                             <Border Grid.Row="2" Background="#1A1A2E" BorderBrush="#0F3460" BorderThickness="0,1,0,0" Padding="20,10">
                                 <Border.Effect>
                                     <DropShadowEffect Color="#000000" Direction="90" ShadowDepth="2" Opacity="0.3" BlurRadius="4"/>
                                 </Border.Effect>
                                 <TextBlock x:Name="PlayerStatusText"
                                            Text="Ready to manage player profiles"
                                            FontSize="14"
                                            Foreground="#CCCCCC"
                                            VerticalAlignment="Center"/>
                             </Border>
                         </Grid>
                         
                         <!-- Analytics Page -->
                         <Grid x:Name="AnalyticsPage" Visibility="Collapsed" Background="Transparent">
                             <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                 <TextBlock Text="ðŸ“ˆ Analytics" FontSize="32" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,20" Foreground="White"/>
                                 <TextBlock Text="Performance charts and insights" FontSize="18" HorizontalAlignment="Center" Opacity="0.7" Foreground="#CCCCCC"/>
                             </StackPanel>
                         </Grid>
                        <!-- Settings Page -->
                        <Grid x:Name="SettingsPage" Visibility="Collapsed" Background="Transparent">
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock Text="âš™ï¸ Settings" FontSize="32" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,20" Foreground="White"/>
                                <TextBlock Text="Settings will be available soon!" FontSize="18" HorizontalAlignment="Center" Opacity="0.7" Foreground="#CCCCCC"/>
                            </StackPanel>
                        </Grid>
                         <!-- Session Management Page -->
                         <Grid x:Name="SessionManagementPage" Visibility="Collapsed" Background="Transparent">
                             <Grid.RowDefinitions>
                                 <RowDefinition Height="Auto"/>
                                 <RowDefinition Height="*"/>
                                 <RowDefinition Height="Auto"/>
                             </Grid.RowDefinitions>

                             <!-- Page Header -->
                             <Border x:Name="SessionManagementHeader" Grid.Row="0" BorderBrush="#0F3460" BorderThickness="0,0,0,1" Padding="20">
                                 <Border.Background>
                                     <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                         <GradientStop Color="#802A2A4E" Offset="0"/>
                                         <GradientStop Color="#801A1A2E" Offset="0.6"/>
                                         <GradientStop Color="#800F0F1F" Offset="1"/>
                                     </LinearGradientBrush>
                                 </Border.Background>
                                 <Border.Effect>
                                     <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" Opacity="0.4" BlurRadius="6"/>
                                 </Border.Effect>
                                                                  <Grid>
                                     <Grid.RowDefinitions>
                                         <RowDefinition Height="Auto"/>
                                         <RowDefinition Height="*"/>
                                     </Grid.RowDefinitions>
                                     <!-- Inner highlight for shine effect -->
                                     <Border Background="Transparent" BorderBrush="#40FFFFFF" BorderThickness="0,0,0,1" Opacity="0.3" Grid.RowSpan="2"/>
                                     <Grid Grid.Row="1">
                                         <Grid.ColumnDefinitions>
                                             <ColumnDefinition Width="*"/>
                                             <ColumnDefinition Width="Auto"/>
                                         </Grid.ColumnDefinitions>
                                     <StackPanel Grid.Column="0">
                                         <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                             <TextBlock x:Name="ManagementTitleText"
                                                        Text="Session Management"
                                                        FontSize="24"
                                                        FontWeight="Bold"
                                                        Foreground="White"
                                                        VerticalAlignment="Center"/>
                                             <ui:Button x:Name="RenameSessionButton"
                                                        Content="âœï¸"
                                                        ToolTip="Rename Session"
                                                        Width="32" Height="32"
                                                        Margin="10,0,0,0"
                                                        VerticalAlignment="Center"
                                                        Click="RenameSessionButton_Click"/>
                                         </StackPanel>
                                         <TextBlock x:Name="ManagementSessionInfo"
                                                    Text="No active session"
                                                    FontSize="14"
                                                    Foreground="#CCCCCC"
                                                    Opacity="0.7"
                                                    Margin="0,5,0,0"/>
                                     </StackPanel>
                                     <StackPanel Grid.Column="1" Orientation="Horizontal">
                                         <ui:Button x:Name="LoadSessionButton"
                                                    Content="ðŸ“‚ Load Session"
                                                    Appearance="Primary"
                                                    Margin="0,0,10,0"
                                                    Click="LoadSessionButton_Click"/>
                                         <ui:Button x:Name="EndManagementSessionButton"
                                                    Content="ðŸ End Session"
                                                    Appearance="Secondary"
                                                    Click="EndManagementSessionButton_Click"/>
                                     </StackPanel>
                                 </Grid>
                                 </Grid>
                             </Border>

                             <!-- Main Content -->
                             <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="20" Background="Transparent">
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>

                                     <!-- Left Column - Player Management -->
                                     <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                         <!-- Player List -->
                                         <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Margin="0,0,0,20">
                                             <Grid Margin="20">
                                                 <Grid.RowDefinitions>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="*"/>
                                                 </Grid.RowDefinitions>
                                                 <TextBlock Grid.Row="0" Text="ðŸ‘¥ Players and Buy-ins" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                                 <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Background="Transparent">
                                                     <ItemsControl x:Name="ManagementPlayersList">
                                                         <ItemsControl.ItemTemplate>
                                                             <DataTemplate>
                                                                 <Border Background="#80000000" CornerRadius="8" Padding="12" Margin="0,5" BorderBrush="#40FFFFFF" BorderThickness="1">
                                                                     <Grid>
                                                                         <Grid.RowDefinitions>
                                                                             <RowDefinition Height="Auto"/>
                                                                             <RowDefinition Height="Auto"/>
                                                                             <RowDefinition Height="Auto"/>
                                                                         </Grid.RowDefinitions>
                                                                         
                                                                         <!-- Header Row: Player Name + Stats + Action Buttons -->
                                                                         <Grid Grid.Row="0" Margin="0,0,0,8">
                                                                             <Grid.ColumnDefinitions>
                                                                                 <ColumnDefinition Width="Auto"/>
                                                                                 <ColumnDefinition Width="*"/>
                                                                                 <ColumnDefinition Width="Auto"/>
                                                                             </Grid.ColumnDefinitions>
                                                                             
                                                                             <!-- Player Name -->
                                                                             <StackPanel Grid.Column="0" Margin="0">
                                                                                 <TextBlock Text="{Binding Name}" FontSize="15" FontWeight="Bold" Foreground="White"/>
                                                                                 <TextBlock Text="{Binding FirstBuyInTime, StringFormat='Joined: 'HH:mm}" FontSize="10" Foreground="#AAAAAA" Margin="0,1,0,0"/>
                                                                             </StackPanel>
                                                                             
                                                                             <!-- Stats Row -->
                                                                             <Grid Grid.Column="1" Margin="0,0,12,0">
                                                                                 <Grid.ColumnDefinitions>
                                                                                     <ColumnDefinition Width="*"/>
                                                                                     <ColumnDefinition Width="*"/>
                                                                                     <ColumnDefinition Width="*"/>
                                                                                 </Grid.ColumnDefinitions>
                                                                                 <StackPanel Grid.Column="0">
                                                                                     <TextBlock Text="Buy-in" FontSize="9" Foreground="#AAAAAA"/>
                                                                                     <TextBlock Text="{Binding TotalBuyIn, StringFormat=C}" FontSize="12" FontWeight="SemiBold" Foreground="#4A90E2"/>
                                                                                 </StackPanel>
                                                                                 <StackPanel Grid.Column="1">
                                                                                     <TextBlock Text="Cash-out" FontSize="9" Foreground="#AAAAAA"/>
                                                                                     <TextBlock Text="{Binding TotalCashOut, StringFormat=C}" FontSize="12" FontWeight="SemiBold" Foreground="#FF8C00"/>
                                                                                 </StackPanel>
                                                                                 <StackPanel Grid.Column="2">
                                                                                     <TextBlock Text="Current Stack" FontSize="9" Foreground="#AAAAAA"/>
                                                                                     <TextBlock Text="{Binding CurrentStack, StringFormat=C}" FontSize="12" FontWeight="SemiBold">
                                                                                         <TextBlock.Foreground>
                                                                                             <SolidColorBrush Color="{Binding CurrentStack, Converter={StaticResource ProfitColorConverter}}"/>
                                                                                         </TextBlock.Foreground>
                                                                                     </TextBlock>
                                                                                 </StackPanel>
                                                                             </Grid>
                                                                             
                                                                             <!-- Action Buttons -->
                                                                             <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                                                 <ui:Button Content="ðŸ’°" ToolTip="Add Buy-in" Width="48" Height="32" FontSize="16" Click="ManagementAddBuyIn_Click" Tag="{Binding Name}" Margin="0,0,2,0" Background="#4A90E2" BorderBrush="#357ABD" Foreground="White"/>
                                                                                 <ui:Button Content="ðŸ’µ" ToolTip="Partial Cash-out (mid-game)" Width="48" Height="32" FontSize="16" Click="ManagementSetCashOut_Click" Tag="{Binding Name}" Margin="0,0,2,0" Background="#FF8C00" BorderBrush="#E67E22" Foreground="White"/>
                                                                                 <ui:Button Content="ðŸ" ToolTip="Set Final Stack (end of session)" Width="48" Height="32" FontSize="16" Click="ManagementSetFinalStack_Click" Tag="{Binding Name}" Background="#5CB85C" BorderBrush="#4CAE4C" Foreground="White"/>
                                                                             </StackPanel>
                                                                         </Grid>
                                                                         
                                                                        <!-- Bottom Row: Database Info + Session Activity + Button + P/L Box -->
                                                                        <!-- WORKING SOLUTION: StackPanel Background (proven to align perfectly) -->
                                                                        <Grid Grid.Row="1" Margin="0">
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="*"/>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                            </Grid.ColumnDefinitions>
                                                                            
                                                                            <!-- Left content - Database Info + Session Activity -->
                                                                            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0">
                                                                                <!-- Database Info - StackPanel with background instead of Border -->
                                                                                <StackPanel Background="#40000000" Margin="0">
                                                                                    <TextBlock Text="Database Info" FontSize="12" FontWeight="SemiBold" Foreground="#CCCCCC" Margin="6,4,6,3"/>
                                                                                    <TextBlock Text="{Binding ProfileCreatedDate, StringFormat='First Created: {0:MM/dd HH:mm}'}" FontSize="11" Foreground="#AAAAAA" Margin="6,0,6,1"/>
                                                                                    <TextBlock Text="{Binding ProfileLastPlayedDate, StringFormat='Last Played: {0:MM/dd HH:mm}'}" FontSize="11" Foreground="#AAAAAA" Margin="6,1,6,4"/>
                                                                                </StackPanel>
                                                                                
                                                                                <!-- 2px spacer -->
                                                                                <Rectangle Width="2" Height="1" Fill="Transparent"/>
                                                                                
                                                                                <!-- Session Activity - StackPanel with background instead of Border -->
                                                                                <StackPanel Background="#40000000" Margin="0">
                                                                                    <TextBlock Text="Session Activity" FontSize="12" FontWeight="SemiBold" Foreground="#CCCCCC" Margin="6,4,6,3"/>
                                                                                    <TextBlock Text="{Binding RecentActivity1}" FontSize="11" Foreground="#BBBBBB" TextTrimming="CharacterEllipsis" Margin="6,0,6,2"/>
                                                                                    <TextBlock Text="{Binding RecentActivity2}" FontSize="11" Foreground="#BBBBBB" TextTrimming="CharacterEllipsis" Margin="6,0,6,4"/>
                                                                                </StackPanel>
                                                                            </StackPanel>
                                                                            
                                                                            <!-- Expand Button -->
                                                                            <Button Grid.Column="1" Width="40" Height="32" FontSize="16" FontFamily="Segoe UI Symbol"
                                                                                   Background="#40000000" BorderBrush="#60FFFFFF" BorderThickness="1" Foreground="White"
                                                                                   ToolTip="Expand activity log" Click="ExpandActivityLog_Click" Tag="{Binding Name}" 
                                                                                   Margin="6,0,6,0" VerticalAlignment="Center">
                                                                                <TextBlock Text="â€¢â€¢â€¢" FontSize="14" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                            </Button>
                                                                            
                                                                            <!-- P/L Box -->
                                                                            <Border Grid.Column="2" CornerRadius="3" Padding="6,3" Margin="0" VerticalAlignment="Center">
                                                                                <Border.Background>
                                                                                    <SolidColorBrush Color="{Binding Profit, Converter={StaticResource StatusColorConverter}}"/>
                                                                                </Border.Background>
                                                                                <StackPanel>
                                                                                    <TextBlock Text="P/L" FontSize="9" Foreground="White" HorizontalAlignment="Center" Margin="0"/>
                                                                                    <TextBlock Text="{Binding Profit, StringFormat=C}" FontSize="11" FontWeight="Bold" HorizontalAlignment="Center" Margin="0">
                                                                                        <TextBlock.Foreground>
                                                                                            <Binding Path="Profit" Converter="{StaticResource ProfitTextColorConverter}"/>
                                                                                        </TextBlock.Foreground>
                                                                                    </TextBlock>
                                                                                </StackPanel>
                                                                                                                                                         </Border>
                                                                         </Grid>
                                                                         
                                                                         <!-- Buy-in Line Graph -->
                                                                         <Border Grid.Row="2" Background="#20000000" CornerRadius="4" Padding="8,6" Margin="0,8,0,0">
                                                                             <StackPanel>
                                                                                 <TextBlock Text="ðŸ“ˆ Buy-in Progression" FontSize="10" FontWeight="SemiBold" Foreground="#CCCCCC" Margin="0,0,0,4"/>
                                                                                 <controls:BuyInLineGraph x:Name="BuyInGraph" Height="50" Width="Auto" HorizontalAlignment="Stretch" BuyInData="{Binding BuyInGraphData}"/>
                                                                             </StackPanel>
                                                                         </Border>
                                                                     </Grid>
                                                                 </Border>
                                                             </DataTemplate>
                                                         </ItemsControl.ItemTemplate>
                                                     </ItemsControl>
                                                 </ScrollViewer>
                                             </Grid>
                                         </Border>

                                     </StackPanel>

                                     <!-- Right Column - Session Details -->
                                     <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                         <!-- Session Totals -->
                                         <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Margin="0,0,0,20">
                                             <Grid Margin="20">
                                                 <Grid.RowDefinitions>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                 </Grid.RowDefinitions>
                                                 <TextBlock Grid.Row="0" Text="ðŸ“Š Session Totals" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                                 <Grid Grid.Row="1" Margin="0,5">
                                                     <Grid.ColumnDefinitions>
                                                         <ColumnDefinition Width="*"/>
                                                         <ColumnDefinition Width="Auto"/>
                                                     </Grid.ColumnDefinitions>
                                                     <TextBlock Grid.Column="0" Text="Total Buy-ins:" FontSize="14" Foreground="#CCCCCC"/>
                                                     <TextBlock Grid.Column="1" Text="{Binding TotalBuyIn}" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                                 </Grid>
                                                                                                 <Grid Grid.Row="2" Margin="0,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="Total Cash-outs:" FontSize="14" Foreground="#CCCCCC"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding TotalCashOut}" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                                </Grid>
                                                <Grid Grid.Row="3" Margin="0,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="Chips on Table:" FontSize="14" Foreground="#CCCCCC"/>
                                                    <TextBlock Grid.Column="1" x:Name="ManagementTotalFinalStacksText" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                                </Grid>
                                                <Grid Grid.Row="4" Margin="0,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="Session Balance:" FontSize="14" Foreground="#CCCCCC"/>
                                                    <TextBlock Grid.Column="1" x:Name="ManagementSessionBalanceText" FontSize="14" FontWeight="Bold"/>
                                                </Grid>
                                                 <Border Grid.Row="5" Height="1" Background="#40FFFFFF" Margin="0,10"/>
                                                 <TextBlock Grid.Row="6" Text="Session Status" FontSize="12" FontWeight="SemiBold" Foreground="#CCCCCC" Margin="0,15,0,5"/>
                                                 <TextBlock Grid.Row="7" x:Name="ManagementSessionStatusText" Text="No active session" FontSize="12" Foreground="#FF6B6B" Margin="0,5,0,0"/>
                                             </Grid>
                                         </Border>

                                         <!-- Quick Actions -->
                                         <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Margin="0,0,0,20">
                                             <Grid Margin="20">
                                                 <Grid.RowDefinitions>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="Auto"/>
                                                 </Grid.RowDefinitions>
                                                 <TextBlock Grid.Row="0" Text="âš¡ Quick Actions" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                                 <ui:Button Grid.Row="1" Content="ðŸ‘¤ Add Player" Appearance="Primary" Margin="0,0,0,10" Click="AddPlayerToActiveSession_Click" Visibility="{Binding CurrentSession, Converter={StaticResource SessionVisibilityConverter}}"/>
                                                 <ui:Button Grid.Row="2" Content="ðŸ“Š Calculate Optimal Payouts" Appearance="Primary" Margin="0,0,0,10" Click="CalculateOptimalPayouts_Click"/>
                                                 <ui:Button Grid.Row="3" Content="ðŸ“‹ Session Summary" Appearance="Secondary" Click="ShowSessionSummary_Click"/>
                                             </Grid>
                                         </Border>

                                         <!-- Session Notes -->
                                         <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Margin="0,0,0,20">
                                             <Grid Margin="20">
                                                 <Grid.RowDefinitions>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="*"/>
                                                     <RowDefinition Height="Auto"/>
                                                 </Grid.RowDefinitions>
                                                 <TextBlock Grid.Row="0" Text="ðŸ“ Session Notes" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                                 <ui:TextBox Grid.Row="1" x:Name="ManagementSessionNotesTextBox"
                                                             AcceptsReturn="True"
                                                             TextWrapping="Wrap"
                                                             Height="120"
                                                             PlaceholderText="Add session notes here..."
                                                             Text="{Binding SessionNotes, UpdateSourceTrigger=PropertyChanged}"/>
                                                 <ui:Button Grid.Row="2" Content="ðŸ’¾ Save Notes" Appearance="Secondary" Margin="0,10,0,0" Click="SaveSessionButton_Click"/>
                                             </Grid>
                                         </Border>

                                         <!-- Session Activity -->
                                         <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8">
                                             <Grid Margin="20">
                                                 <Grid.RowDefinitions>
                                                     <RowDefinition Height="Auto"/>
                                                     <RowDefinition Height="*"/>
                                                 </Grid.RowDefinitions>
                                                 <TextBlock Grid.Row="0" Text="ðŸ“Š Session Activity" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="White"/>
                                                 <ScrollViewer Grid.Row="1" MaxHeight="200" VerticalScrollBarVisibility="Auto" Background="Transparent">
                                                     <ItemsControl x:Name="SessionActivityList">
                                                         <ItemsControl.ItemTemplate>
                                                             <DataTemplate>
                                                                 <Border Background="#80000000" CornerRadius="4" Padding="8" Margin="0,2" BorderBrush="#40FFFFFF" BorderThickness="1">
                                                                     <Grid>
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                             <ColumnDefinition Width="*"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         
                                                                         <!-- Transaction Type Icon -->
                                                                         <TextBlock Grid.Column="0" 
                                                                                    Text="{Binding TypeIcon}" 
                                                                                    FontSize="16" 
                                                                                    Foreground="{Binding TypeColor}" 
                                                                                    Margin="0,0,8,0" 
                                                                                    VerticalAlignment="Center"/>
                                                                         
                                                                         <!-- Transaction Details -->
                                                                         <StackPanel Grid.Column="1" Margin="0">
                                                                             <TextBlock Text="{Binding PlayerName}" FontSize="12" FontWeight="SemiBold" Foreground="White"/>
                                                                             <TextBlock Text="{Binding Description}" FontSize="11" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                                                             <TextBlock Text="{Binding Note}" FontSize="10" Foreground="#888888" TextWrapping="Wrap" Visibility="{Binding NoteVisibility}"/>
                                                                         </StackPanel>
                                                                         
                                                                         <!-- Amount and Time -->
                                                                         <StackPanel Grid.Column="2" HorizontalAlignment="Right" Margin="8,0,0,0">
                                                                             <TextBlock Text="{Binding Amount}" FontSize="12" FontWeight="Bold" Foreground="{Binding TypeColor}" HorizontalAlignment="Right"/>
                                                                             <TextBlock Text="{Binding Time}" FontSize="10" Foreground="#888888" HorizontalAlignment="Right"/>
                                                                         </StackPanel>
                                                                     </Grid>
                                                                 </Border>
                                                             </DataTemplate>
                                                         </ItemsControl.ItemTemplate>
                                                     </ItemsControl>
                                                 </ScrollViewer>
                                             </Grid>
                                         </Border>
                                     </StackPanel>
                                 </Grid>
                             </ScrollViewer>

                             <!-- Status Bar -->
                             <Border Grid.Row="2" Background="#1A1A2E" BorderBrush="#0F3460" BorderThickness="0,1,0,0" Padding="20,10">
                                 <Border.Effect>
                                     <DropShadowEffect Color="#000000" Direction="90" ShadowDepth="2" Opacity="0.3" BlurRadius="4"/>
                                 </Border.Effect>
                                 <TextBlock x:Name="ManagementStatusText"
                                            Text="Ready to manage your poker session"
                                            FontSize="14"
                                            Foreground="#CCCCCC"
                                            VerticalAlignment="Center"/>
                             </Border>
                         </Grid>

                         <!-- Debug Page -->
                         <Grid x:Name="DebugPage" Visibility="Collapsed" Background="Transparent">
                             <Grid.RowDefinitions>
                                 <RowDefinition Height="Auto"/>
                                 <RowDefinition Height="*"/>
                                 <RowDefinition Height="Auto"/>
                             </Grid.RowDefinitions>

                             <!-- Page Header -->
                             <Border x:Name="DebugHeader" Grid.Row="0" BorderBrush="#0F3460" BorderThickness="0,0,0,1" Padding="20">
                                 <Border.Background>
                                     <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                         <GradientStop Color="#802A2A4E" Offset="0"/>
                                         <GradientStop Color="#801A1A2E" Offset="0.6"/>
                                         <GradientStop Color="#800F0F1F" Offset="1"/>
                                     </LinearGradientBrush>
                                 </Border.Background>
                                 <Border.Effect>
                                     <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" Opacity="0.4" BlurRadius="6"/>
                                 </Border.Effect>
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="Auto"/>
                                     </Grid.ColumnDefinitions>
                                     <Border Background="Transparent" BorderBrush="#40FFFFFF" BorderThickness="0,0,0,1" Opacity="0.3"/>
                                     <StackPanel Grid.Column="0">
                                         <TextBlock Text="ðŸ› Debug Console"
                                                    FontSize="24"
                                                    FontWeight="Bold"
                                                    Foreground="White"
                                                    VerticalAlignment="Center"/>
                                         <TextBlock Text="Live Firebase and application debug information"
                                                    FontSize="14"
                                                    Foreground="#CCCCCC"
                                                    Opacity="0.7"
                                                    Margin="0,5,0,0"/>
                                     </StackPanel>
                                     <StackPanel Grid.Column="1" Orientation="Horizontal">
                                         <ui:Button x:Name="ClearDebugButton"
                                                    Content="ðŸ—‘ï¸ Clear"
                                                    Appearance="Secondary"
                                                    Margin="0,0,10,0"
                                                    Click="ClearDebug_Click"/>
                                         <ui:Button x:Name="TestFirebaseDebugButton"
                                                    Content="ðŸ”— Test Firebase"
                                                    Appearance="Primary"
                                                    Click="TestFirebaseDebug_Click"/>
                                     </StackPanel>
                                 </Grid>
                             </Border>

                             <!-- Debug Console -->
                             <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="20" Background="Transparent">
                                 <Border Background="#A0000000" BorderBrush="#60FFFFFF" BorderThickness="1" CornerRadius="8" Padding="20">
                                     <ScrollViewer x:Name="DebugConsoleScrollViewer" 
                                                   VerticalScrollBarVisibility="Auto" 
                                                   Background="Transparent"
                                                   FontFamily="Consolas, Courier New, monospace"
                                                   FontSize="12">
                                         <TextBlock x:Name="DebugConsoleText"
                                                    Foreground="#00FF00"
                                                    TextWrapping="Wrap"
                                                    Text="ðŸ› Debug Console Ready...
ðŸ“¡ Waiting for debug information...
ðŸ” Click 'Test Firebase' to start debugging...
"/>
                                     </ScrollViewer>
                                 </Border>
                             </ScrollViewer>

                             <!-- Status Bar -->
                             <Border Grid.Row="2" Background="#1A1A2E" BorderBrush="#0F3460" BorderThickness="0,1,0,0" Padding="20,10">
                                 <Border.Effect>
                                     <DropShadowEffect Color="#000000" Direction="90" ShadowDepth="2" Opacity="0.3" BlurRadius="4"/>
                                 </Border.Effect>
                                 <TextBlock x:Name="DebugStatusText"
                                            Text="Debug console ready - monitoring Firebase operations"
                                            FontSize="14"
                                            Foreground="#CCCCCC"
                                            VerticalAlignment="Center"/>
                             </Border>
                         </Grid>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>


    </Border>
</Window> 